<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>job5 åœ¨çº¿è´­ç‰©æŠ˜æ‰£</title>

<style>
  body { font-family: Arial; padding: 10px; }
  input, select { margin: 3px 0; padding: 4px; }
  table { border-collapse: collapse; margin-top: 10px; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 6px; }
  #tips { background: #eef; padding: 10px; white-space: pre-line; }
</style>

<script>

  /**
   * document.write()
   * åŠŸèƒ½ï¼šå‘ HTML é¡µé¢â€œç›´æ¥å†™å…¥â€å†…å®¹ï¼Œç›¸å½“äºæ’å…¥ HTML ä»£ç ã€‚
   * ç‰¹ç‚¹ï¼šåœ¨é¡µé¢åŠ è½½æ—¶æ‰§è¡Œï¼Œé€‚åˆè¾“å‡ºæ ‡é¢˜ã€æç¤ºåŒºåŸŸã€‚
   */
  document.write("<h1>XXç”µå•† Â· è¿è¥åå° Â· è®¢å•å½•å…¥ä¸é”€å”®çœ‹æ¿</h1>");
  document.write("<p>æ¬¢è¿ä½¿ç”¨å†…éƒ¨å·¥å…·ï¼Œå®æ—¶æŸ¥çœ‹è®¢å•ä¸é”€å”®æƒ…å†µã€‚</p>");

  // ===================== å…¨å±€ä¼˜æƒ  + åŠ ä»·æ¸©é¦¨æç¤º =====================
  document.write(`
  <div style="padding:12px; border-left:5px solid #3aa0e6; margin:10px 0; font-size:15px;">
    <strong>ğŸ’¡ æ¸©é¦¨æç¤ºï¼šæœ¬åº—å½“å‰å¯äº«å—çš„ä¼˜æƒ ä¸åŠ ä»·æ”¿ç­–å¦‚ä¸‹ï¼š</strong>
    <ul style="margin:8px 0 0 20px; line-height:1.6;">
      <li>ğŸ‰ VIP å®¢æˆ·äº«å— <strong>9 æŠ˜ä¼˜æƒ </strong></li>
      <li>âš¡ åŠ æ€¥å‘è´§ä»·æ ¼ä¼š <strong>Ã—1.1</strong></li>
      <li>â° æ¯å°æ—¶å‰ 10 åˆ†é’Ÿå†äº« <strong>8.5 æŠ˜</strong></li>
    </ul>
  </div>
  `);

  // ===================== å½“å‰åˆ†é’ŸåŠ¨æ€æ´»åŠ¨æç¤º =====================
  var nowForBanner = new Date();            // Date()ï¼šåˆ›å»ºä¸€ä¸ªæ—¶é—´å¯¹è±¡
  var minuteForBanner = nowForBanner.getMinutes(); // getMinutes()ï¼šè·å–å½“å‰åˆ†é’Ÿï¼ˆ0â€“59ï¼‰

  if (minuteForBanner >= 0 && minuteForBanner <= 9) {
    document.write(`
      <div style="padding:12px; background:#fffbe6; border-left:5px solid #f4d06f; margin:10px 0; font-size:15px;">
        â³ å½“å‰ä¸ºå‰ 10 åˆ†é’Ÿï¼æœ¬å•å¯é¢å¤–äº«å— <strong>8.5 æŠ˜</strong> æ—¶æ®µä¼˜æƒ ï¼
      </div>
    `);
  } else {
    document.write(`
      <div style="padding:12px; background:#f5f5f5; border-left:5px solid #ccc; margin:10px 0; font-size:15px;">
        ğŸ•’ å°è´´å£«ï¼šæ¯ä¸ªæ•´ç‚¹å‰ 10 åˆ†é’Ÿäº«å— 8.5 æŠ˜ä¼˜æƒ ï¼Œè¯·ç•™æ„ä¸‹å•æ—¶é—´ï½
      </div>
    `);
  }

var orderList = [];     
var stuLastDigit = 3;   

function showClock() {
    var now = new Date();
    var h = now.getHours();
    var m = now.getMinutes();
    var s = now.getSeconds();
    var t = h + ":" + (m<10?"0"+m:m) + ":" + (s<10?"0"+s:s);

    var note = (m <= 9) ? "ï¼ˆå‰10åˆ†é’Ÿï¼š85æŠ˜ï¼‰" : "ï¼ˆæ— æ—¶é—´æŠ˜æ‰£ï¼‰";

    document.getElementById("clock").innerHTML = t + note;
}
setInterval(showClock, 1000);

function addOrder() {

    var name = document.getElementById("name").value;
    var price = parseFloat(document.getElementById("price").value);
    var qty = parseInt(document.getElementById("qty").value);
    var vip = document.getElementById("vip").value === "true";
    var urgent = document.getElementById("urgent").checked;

    if (name == "") { alert("å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©º"); return; }
    if (isNaN(price) || price <= 0) { alert("å•ä»·å¿…é¡» > 0"); return; }
    if (!Number.isInteger(qty) || qty <= 0) { alert("æ•°é‡å¿…é¡»æ˜¯æ•´æ•°ä¸” > 0"); return; }

    var now = new Date();
    var minute = now.getMinutes();

    // åŸºç¡€ä»·æ ¼
    var baseTotal = price * qty;

    // VIPï¼ˆä¹æŠ˜ï¼‰
    var afterVip = vip ? baseTotal * 0.9 : baseTotal;

    // åŠ æ€¥ï¼ˆ+10%ï¼‰
    var afterUrgent = urgent ? afterVip * 1.1 : afterVip;

    // æ—¶é—´æŠ˜æ‰£ï¼ˆå‰ååˆ†é’Ÿï¼‰
    var hitTime = (minute <= 9);
    var finalTotal = hitTime ? afterUrgent * 0.85 : afterUrgent;

    // â˜…â˜…â˜… å­¦å·æœ«ä½ 3 çš„ç‰¹æ®Šé€»è¾‘
    if (vip && finalTotal > 1000) {
        finalTotal = finalTotal - 50;
        if (finalTotal < 0) finalTotal = 0;
    }

    finalTotal = finalTotal.toFixed(2);

    // è®°å½•åˆ°æ•°ç»„ï¼ˆå‚è€ƒ jsc.htmlï¼špush è®°å½•è®¢å•ï¼‰
    orderList.push({
        time: now.toLocaleString(),
        name: name,
        price: price,
        qty: qty,
        vip: vip,
        urgent: urgent,
        minute: minute,
        final: finalTotal
    });

    // æ˜¾ç¤ºè®¡ç®—è¿‡ç¨‹ï¼ˆå‚è€ƒç¤ºä¾‹ï¼štipsHtml +=ï¼‰
    var tipsHtml = "";
    tipsHtml += "åŸºç¡€æ€»ä»·" + baseTotal.toFixed(2) + " å…ƒ\n";
    tipsHtml += "VIP æŠ˜æ‰£å= " + afterVip.toFixed(2) + " å…ƒ\n";
    tipsHtml += "åŠ æ€¥å= " + afterUrgent.toFixed(2) + " å…ƒ\n";
    tipsHtml += "å½“å‰åˆ†é’Ÿ= " + minute + "\n";
    tipsHtml += "æ˜¯å¦æ—¶é—´æŠ˜æ‰£ = " + (hitTime ? "æ˜¯ï¼ˆ85æŠ˜ï¼‰" : "å¦") + "\n";
    tipsHtml += "æœ€ç»ˆé‡‘é¢= " + finalTotal + " å…ƒ\n";
    document.getElementById("tips").innerText = tipsHtml;

    renderTable();
}

function renderTable() {
    if (orderList.length == 0) {
        document.getElementById("history").innerHTML = "æš‚æ— è®°å½•";
        return;
    }

    var html = "<table>";
    html += "<tr><th>#</th><th>æ—¶é—´</th><th>å®¢æˆ·</th><th>å•ä»·</th><th>æ•°é‡</th><th>VIP</th><th>åŠ æ€¥</th><th>åˆ†é’Ÿ</th><th>é‡‘é¢</th></tr>";

    for (var i = 0; i < orderList.length; i++) {
        var o = orderList[i];
        html += "<tr>";
        html += "<td>" + (i+1) + "</td>";
        html += "<td>" + o.time + "</td>";
        html += "<td>" + o.name + "</td>";
        html += "<td>" + o.price + "</td>";
        html += "<td>" + o.qty + "</td>";
        html += "<td>" + (o.vip?"æ˜¯":"å¦") + "</td>";
        html += "<td>" + (o.urgent?"æ˜¯":"å¦") + "</td>";
        html += "<td>" + o.minute + "</td>";
        html += "<td>" + o.final + "</td>";
        html += "</tr>";
    }

    html += "</table>";

    document.getElementById("history").innerHTML = html;
}
</script>

</head>

<body>

<h2>åœ¨çº¿è´­ç‰©æŠ˜æ‰£ï¼ˆjob5 ä½œä¸šï¼‰</h2>
<p>å½“å‰æ—¶é—´ï¼š<span id="clock">--:--:--</span></p>

å®¢æˆ·åï¼š<br>
<input id="name"><br>

å•ä»·ï¼š<br>
<input id="price" type="number"><br>

æ•°é‡ï¼š<br>
<input id="qty" type="number"><br>

å®¢æˆ·ç±»å‹ï¼š<br>
<select id="vip">
  <option value="false">æ™®é€šç”¨æˆ·</option>
  <option value="true">VIP</option>
</select><br>

<label>
  <input type="checkbox" id="urgent"> åŠ æ€¥ï¼ˆ+10%ï¼‰
</label><br><br>

<button onclick="addOrder()">æ·»åŠ è®¢å•</button>

<h3>è®¡ç®—è¿‡ç¨‹</h3>
<pre id="tips"></pre>

<h3>è®¢å•å†å²</h3>
<div id="history">æš‚æ— è®°å½•</div>

</body>
</html>
